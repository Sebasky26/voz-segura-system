@startuml C4_Context
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

title Diagrama C4 - Sistema Voz Segura (Plataforma de Denuncias Anónimas)

Person(denunciante, "Denunciante", "Usuario que registra denuncias anónimas")
Person(supervisor, "Supervisor", "Revisa y gestiona denuncias")
Person(admin, "Administrador", "Gestiona usuarios y sistema")

System_Boundary(vozsegura, "Sistema Voz Segura") {
    Container(webapp, "Aplicación Web Next.js", "Next.js 16, React 19, TypeScript", "Aplicación monolítica que incluye frontend y backend API")
    Container(websocket, "Socket.IO Server", "Socket.IO 4.8.1", "Servidor WebSocket para chat en tiempo real")
    ContainerDb(database, "Base de Datos", "PostgreSQL", "Almacena usuarios, denuncias, evidencias, chat y auditoría")
}

System_Ext(jwt, "JWT Service", "Autenticación con tokens JWT (7 días)")
System_Ext(bcrypt, "bcrypt", "Cifrado de contraseñas (12 rounds)")

Rel(denunciante, webapp, "Usa", "HTTPS")
Rel(supervisor, webapp, "Usa", "HTTPS")
Rel(admin, webapp, "Usa", "HTTPS")

Rel(denunciante, websocket, "Chat tiempo real", "WebSocket")
Rel(supervisor, websocket, "Chat tiempo real", "WebSocket")

Rel(webapp, database, "Lee/Escribe", "Prisma ORM")
Rel(websocket, database, "Guarda mensajes", "Prisma ORM")

Rel(webapp, jwt, "Genera/Verifica tokens")
Rel(webapp, bcrypt, "Hash/Verifica passwords")

@enduml
